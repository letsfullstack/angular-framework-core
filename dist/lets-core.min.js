!function(){"use strict";function e(){this.headers={};this.set=function(e,t){this.headers[e]=t},this.get=function(e){return this.headers[e].findLabel=function(e){for(var t in this.fields){var n=this.fields[t];if(n.name==e)return n.label}},this.headers[e].get=function(e){for(var t in this.fields){var n=this.fields[t];if(n.name==e)return n}},this.headers[e]},this.$get=function(){return this}}function t(e,t){}var n=angular.module("letsAngular",["ui.router","ngAnimate","ui.bootstrap","angular.viacep","ngCpfCnpj","ui.mask","ui.jq","ui.event","ngFileUpload","moment-filter","checklist-model","ui.toggle","ui.select","ngSanitize","colorpicker-dr","ckeditor","thatisuday.dropzone"]);n.config(t),n.provider("headers",e),t.$inject=["$stateProvider","$httpProvider"]}(),function(){"use strict";function e(){var e=this;return e._placeholderList=["paciente"],e._placeholderAttr=["nome"],e.removeAccents=function(e){var t="ÀÁÂÃÄÅàáâãäåßÒÓÔÕÕÖØòóôõöøÈÉÊËèéêëðÇçÐÌÍÎÏìíîïÙÚÛÜùúûüÑñŠšŸÿýŽž",n="AAAAAAaaaaaaBOOOOOOOooooooEEEEeeeeeCcDIIIIiiiiUUUUuuuuNnSsYyyZz";e=e.split("");var a,i,o=e.length;for(a=0;o>a;a++)-1!=(i=t.indexOf(e[a]))&&(e[a]=n[i]);return e.join("")},e._removeSpecialChars=function(e){var t="!@#$%*()-_+=/.,:;?[{]}`~^|";e=e.split("");var n,a=e.length;for(n=0;a>n;n++)-1!=t.indexOf(e[n])&&(e[n]="");return e.join("")},e.lemmatize=function(t){return t=e.removeAccents(t),e._removeSpecialChars(t)},e.changePlaceholders=function(t,n){return e._placeholderList.forEach(function(a,i){if(n[a]){var o="["+a.toUpperCase()+"]";if(-1!==t.indexOf(o)){var r=t.split(o),l="",s=r.length;r.forEach(function(t,o){l+=t,s-1>o&&(l+=n[a][e._placeholderAttr[i]])}),t=l}}}),t},{removeAccents:e.removeAccents,lemmatize:e.lemmatize,changePlaceholders:e.changePlaceholders}}angular.module("letsAngular").service("utilsStringService",e),e.inject=[]}(),function(){"use strict";function e(e,t,n,a){var i=this;return i._printHTML=function(e){var t=$("<iframe></iframe>").appendTo("body")[0];t.contentWindow.printAndRemove=function(){t.contentWindow.print(),setTimeout(function(){$(t).remove()},3e3)};var n='<!doctype html><html><body onload="printAndRemove();">'+e+"</body></html>",a=t.contentWindow.document.open("text/html","replace");a.write(n),a.close()},i.print=function(o,r){moment.locale("pt-br");var l=angular.extend(t.$new(),r);e(o).then(function(e){var t=n($("<div>"+e+"</div>"))(l),o=function(){l.$$phase?a(o):(i._printHTML(t.html()),l.$destroy())};o()})},{print:i.print}}e.$inject=["$templateRequest","$rootScope","$compile","$timeout"],angular.module("letsAngular").service("utilsPrintService",e),e.inject=["$templateRequest","$rootScope","$compile","$timeout"]}(),function(){"use strict";function e(){var e=this;return e.convertObjSearch=function(e,t){var n={};return Object.keys(e).forEach(function(a){if(e[a])if("object"==typeof e[a]){var i={};Object.keys(e[a]).forEach(function(n){if("createdAt"!==n&&"updatedAt"!==n){var o=n;"id"!==n&&(o="label"),"label"===o&&t&&a===t.relation?i.label=e[a][t.label]:i[o]=e[a][n]}}),n[a+".label"]=i,n[a]=i.id}else-1===a.indexOf("id")&&"createdAt"!==a&&"updatedAt"!==a&&(n[a]=e[a])}),n},e.convertObjLabels=function(e){return e.forEach(function(e){Object.keys(e).forEach(function(t){if("object"==typeof e[t]){var n=t.split(".")[0];"label"===t.split(".")[1]&&(e[n]=angular.copy(e[t]),delete e[t])}})}),e},e.setInputsFromObject=function(e){Object.keys(e).forEach(function(t){if(e[t]&&-1===t.indexOf("hashKey")&&"id"!==t&&"createdAt"!==t&&"updatedAt"!==t){var n=angular.element("#"+t).scope();void 0===n&&-1!==t.indexOf("label")&&(n=angular.element("#"+t.split(".")[0]).scope()),n&&(n.field.autocomplete?"object"==typeof e[t]&&(e[t].label||(e[t].label=e[t].nome),n.$parent.data[t]=e[t].label,n.$parent.data[t+".label"]=e[t]):n.$parent.data[t]=e[t])}})},{convertObjSearch:e.convertObjSearch,convertObjLabels:e.convertObjLabels,setInputsFromObject:e.setInputsFromObject}}angular.module("letsAngular").service("utilsObjectService",e),e.inject=[]}(),function(){"use strict";function e(){var e=this;return e.getDiffDuration=function(e,t,n){moment.isMoment(e)||(e=moment(e)),moment.isMoment(t)||(t=moment(t));var a=moment.duration(e.diff(t));switch(n){case"day":return a.asDays();case"hour":return a.asHours();case"minute":return a.asMinutes();case"second":return a.asSeconds();case"week":return a.asWeeks();case"month":return a.asMonths();case"year":return a.asYears();default:return a.asMilliseconds()}},{getDiffDuration:e.getDiffDuration}}angular.module("letsAngular").service("utilsDateTimeService",e),e.inject=[]}(),function(){"use strict";function e(){var e=this;return e._getFilledFilterAttr=function(e,t){var n={radios:[],checkboxes:[]};return Object.keys(e).forEach(function(t){null!==e[t]&&n.radios.push(t)}),Object.keys(t).forEach(function(e){t[e].length>0&&n.checkboxes.push(e)}),n},e._findCheckAttr=function(e,t){var n=null;return Object.keys(t).forEach(function(a){a===e&&(n=t[a])}),n},e.filterList=function(t,n,a,i,o,r){var l=t.slice(0),s=Object.keys(r).length,c=e._getFilledFilterAttr(n,i),u="neutral";c.checkboxes.forEach(function(e){i[e].length>o[e].length?u="add":i[e].length<o[e].length&&(u="reduce")}),"add"===u&&(l=t.slice(0),u="reduce");var d=[],f=c.checkboxes.length!==s;return f&&l.forEach(function(e,t){e.multiple&&-1===d.indexOf(t)&&d.unshift(t)}),l.forEach(function(t,o){if(t.multiple&&!f)c.checkboxes.forEach(function(n){if("reduce"===u&&i[n].length!==a[n].length){var l=!1,s=e._findCheckAttr(n,r);i[n].forEach(function(e){t[n][s]===e&&(l=!0)}),l||-1===d.indexOf(o)&&d.unshift(o)}});else{var l=!1;c.radios.forEach(function(e){l||(n[e]&&t.label===e?l=!0:n[e]||t.label!==e||(l=!1))}),l||-1===d.indexOf(o)&&d.unshift(o)}}),d.forEach(function(e){l.splice(e,1)}),l.sort(function(e,t){return moment(t.inicio).diff(moment(e.inicio),"seconds")}),l},e.orderList=function(e,t){var n=!1;return Object.keys(e[0]).forEach(function(e){t===e&&(n=!0)}),n?e.sort(function(e,n){return e[t]<n[t]?-1:e[t]>n[t]?1:0}):e},e.getMinMaxValues=function(e,t,n,a,i,o,r){var l={x:r[0][t],y:r[0][i]},s={x:r[0][t],y:r[0][i]};return r.forEach(function(e){e[t]<l.x&&(l.x=e[t]),e[t]>s.x&&(s.x=e[t]),e[i]<l.y&&(l.y=e[i]),e[i]>s.y&&(s.y=e[i])}),"date"===e?(l.x=new Date(moment(l.x).subtract(n,"day").format("MM/DD/YYYY")),s.x=new Date(moment(s.x).add(n,"day").format("MM/DD/YYYY"))):(l.x-=n,s.x+=n),"date"===a?(l.y=new Date(moment(l.y).subtract(o,"day").format("MM/DD/YYYY")),s.y=new Date(moment(s.y).add(o,"day").format("MM/DD/YYYY"))):(l.y-=o,s.y+=o),{min:l,max:s}},{filterList:e.filterList,orderList:e.orderList,getMinMaxValues:e.getMinMaxValues}}angular.module("letsAngular").service("utilsComparatorService",e),e.inject=[]}(),function(){"use strict";function e(e,t,n){var a=this;return a._createModal=function(t){return e.open(t).result},a.createCRUDModal=function(e,n,i,o){return a._createModal({animation:!0,templateUrl:o||"lets/views/crud/crud-modal.html",controller:i||"CRUDFormModalController",resolve:{headers:function(){return e},data:function(){try{var e=angular.copy(n)}catch(a){var e=t.extend({},n)}return e}},size:"lg",backdrop:"static",keyboard:!1})},a.hide=function(){n.$emit("cancel-modal")},{createModal:a._createModal,createCRUDModal:a.createCRUDModal,hide:a.hide}}e.$inject=["$modal","jQuery","$rootScope"],angular.module("letsAngular").service("fwModalService",e),e.inject=["$modal","jQuery","$rootScope"]}(),function(){"use strict";function e(e){var t=this;return t.emitFormErrors=function(t){var n=[],a=Object.keys(t.$error),i=/^([0-9]{2})\/([0-9]{2})\/([0-9]{4})$/;for(var o in a){var r=t.$error[a[o]];for(var l in r){var s=r[l].$options.fieldInfo.label;"required"==a[o]?n.push("O campo "+s+" é obrigatório"):"date"==a[o]&&0==i.test(r[l].$viewValue)&&n.push("O campo "+s+" está com uma data inválida")}}n.length>0&&e.warning(n.join("<br />"))},{emitFormErrors:t.emitFormErrors}}e.$inject=["ngToast"],angular.module("letsAngular").service("fwErrorService",e),e.inject=["ngToast"]}(),function(){"use strict";function e(){var e=this;return e.configD3chart=function(e,t,n){var a=null,i={left:40,bottom:28,right:28,top:28};return n||(n={x:[],y:[0,150]}),a="multibar"===e?nv.models.multiBarChart().margin(i).color(t).yDomain(n.y):nv.models.lineChart().margin(i).color(t).xDomain(n.x).yDomain(n.y),a.xAxis.showMaxMin(!1).tickFormat(function(e){return d3.time.format("%d/%m/%y")(new Date(e))}),a.xScale(d3.time.scale()),a.yAxis.showMaxMin(!1).tickFormat(d3.format(",f")),a.tooltip.enabled(!1),a},e.configD3chartData=function(e,t,n){var a=[];return n.forEach(function(e){var t={x:new Date(moment(e.data).format("MM/DD/YYYY")),y:e.valor};a.push(t)}),[{area:e,key:t,values:a}]},e.getMockD3chartsData=function(e){return e||(e=!1),{glicemiaCapilar:[{area:e,key:"Valor",values:[{x:new Date("06/10/2017").getTime(),y:77},{x:new Date("06/17/2017").getTime(),y:70},{x:new Date("07/01/2017").getTime(),y:121},{x:new Date("07/08/2017").getTime(),y:84},{x:new Date("07/15/2017").getTime(),y:75},{x:new Date("07/22/2017").getTime(),y:80},{x:new Date("07/29/2017").getTime(),y:76},{x:new Date("08/05/2017").getTime(),y:120},{x:new Date("08/12/2017").getTime(),y:77},{x:new Date("08/19/2017").getTime(),y:85}]}],pressao:[{area:e,key:"Sistólica",values:[{x:new Date("06/10/2017").getTime(),y:125},{x:new Date("06/17/2017").getTime(),y:139},{x:new Date("07/01/2017").getTime(),y:129},{x:new Date("07/08/2017").getTime(),y:133},{x:new Date("07/15/2017").getTime(),y:134},{x:new Date("07/22/2017").getTime(),y:133},{x:new Date("07/29/2017").getTime(),y:143},{x:new Date("08/05/2017").getTime(),y:148},{x:new Date("08/12/2017").getTime(),y:139},{x:new Date("08/19/2017").getTime(),y:134}]},{area:e,key:"Diastólica",values:[{x:new Date("06/10/2017").getTime(),y:78},{x:new Date("06/17/2017").getTime(),y:75},{x:new Date("07/01/2017").getTime(),y:83},{x:new Date("07/08/2017").getTime(),y:80},{x:new Date("07/15/2017").getTime(),y:77},{x:new Date("07/22/2017").getTime(),y:79},{x:new Date("07/29/2017").getTime(),y:83},{x:new Date("08/05/2017").getTime(),y:81},{x:new Date("08/12/2017").getTime(),y:74},{x:new Date("08/19/2017").getTime(),y:81}]}],peso:[{area:e,key:"Quilos",values:[{x:new Date("06/10/2017").getTime(),y:89},{x:new Date("06/17/2017").getTime(),y:90},{x:new Date("07/01/2017").getTime(),y:89},{x:new Date("07/08/2017").getTime(),y:92},{x:new Date("07/15/2017").getTime(),y:93},{x:new Date("07/22/2017").getTime(),y:94},{x:new Date("07/29/2017").getTime(),y:93},{x:new Date("08/05/2017").getTime(),y:93},{x:new Date("08/12/2017").getTime(),y:93},{x:new Date("08/19/2017").getTime(),y:92}]}],altura:[{area:e,key:"Metros",values:[{x:new Date("06/10/2017").getTime(),y:1.76},{x:new Date("06/17/2017").getTime(),y:1.76},{x:new Date("07/01/2017").getTime(),y:1.76},{x:new Date("07/08/2017").getTime(),y:1.76},{x:new Date("07/15/2017").getTime(),y:1.76},{x:new Date("07/22/2017").getTime(),y:1.76},{x:new Date("07/29/2017").getTime(),y:1.76},{x:new Date("08/05/2017").getTime(),y:1.76},{x:new Date("08/12/2017").getTime(),y:1.76},{x:new Date("08/19/2017").getTime(),y:1.76}]}],imc:[{area:e,key:"Valor",values:[{x:new Date("06/10/2017").getTime(),y:15.3},{x:new Date("06/17/2017").getTime(),y:15.5},{x:new Date("07/01/2017").getTime(),y:15.3},{x:new Date("07/08/2017").getTime(),y:15.8},{x:new Date("07/15/2017").getTime(),y:16},{x:new Date("07/22/2017").getTime(),y:16.2},{x:new Date("07/29/2017").getTime(),y:16},{x:new Date("08/05/2017").getTime(),y:16},{x:new Date("08/12/2017").getTime(),y:16},{x:new Date("08/19/2017").getTime(),y:15.8}]}],hdlLdl:[{area:e,key:"HDL",values:[{x:new Date("06/10/2017").getTime(),y:43},{x:new Date("06/17/2017").getTime(),y:41},{x:new Date("07/01/2017").getTime(),y:42},{x:new Date("07/08/2017").getTime(),y:45},{x:new Date("07/15/2017").getTime(),y:46},{x:new Date("07/22/2017").getTime(),y:48},{x:new Date("07/29/2017").getTime(),y:44},{x:new Date("08/05/2017").getTime(),y:41},{x:new Date("08/12/2017").getTime(),y:42},{x:new Date("08/19/2017").getTime(),y:40}]},{area:e,key:"LDL",values:[{x:new Date("06/10/2017").getTime(),y:121},{x:new Date("06/17/2017").getTime(),y:130},{x:new Date("07/01/2017").getTime(),y:137},{x:new Date("07/08/2017").getTime(),y:138},{x:new Date("07/15/2017").getTime(),y:120},{x:new Date("07/22/2017").getTime(),y:122},{x:new Date("07/29/2017").getTime(),y:123},{x:new Date("08/05/2017").getTime(),y:124},{x:new Date("08/12/2017").getTime(),y:122},{x:new Date("08/19/2017").getTime(),y:120}]}]}},e.getMockD3chartsConfig=function(){return{glicemiaCapilar:e.configD3chart("line",["#092e64"],{x:[new Date("06/10/2017"),new Date("08/09/2017")],y:[50,130]}),pressao:e.configD3chart("line",["#092e64","#008df5"],{x:[new Date("06/10/2017"),new Date("08/09/2017")],y:[50,150]}),peso:e.configD3chart("line",["#092e64"],{x:[new Date("06/10/2017"),new Date("08/09/2017")],y:[80,100]}),altura:e.configD3chart("line",["#092e64"],{x:[new Date("06/10/2017"),new Date("08/09/2017")],y:[0,2]}),imc:e.configD3chart("line",["#092e64"],{x:[new Date("06/10/2017"),new Date("08/09/2017")],y:[12,20]}),hdlLdl:e.configD3chart("line",["#092e64","#008df5"],{x:[new Date("06/10/2017"),new Date("08/09/2017")],y:[30,150]})}},{getMockD3chartsData:e.getMockD3chartsData,getMockD3chartsConfig:e.getMockD3chartsConfig,configD3chart:e.configD3chart,configD3chartData:e.configD3chartData}}angular.module("letsAngular").service("fwChartService",e),e.inject=[]}(),function(){"use strict";function e(e,t,n,a,i,o,r,l){var s=o.API_URL,c=this;c.updateLocalStorage=function(e,t){var n=c.getUser();n[e]=t,c.setUserInfo(n)},c.setUserLb=function(e){t.setUser(e.id,e.userId,e.user),t.rememberMe=!0,t.save()},c.setUserInfo=function(e){window.localStorage.user=angular.toJson(e)},c.getUser=function(){return window.localStorage.user?JSON.parse(window.localStorage.user):!1},c.isAuthenticated=function(){return null!=t.currentUserId},c.authenticate=function(e){return i.authenticate(e).then(function(e){var t={accessToken:e.access_token};return r.post(s+"users/facebook/token",t)}).then(function(e){var t={id:e.data.id,userId:e.data.user.id,user:e.data.user};c.setUserLb(t),c.setUserInfo(e.data.user),c.removeSatellizer(),a.go("main.search")})["catch"](function(e){console.debug(e)})},c.logout=function(i){n.userLogout({accessToken:i}).$promise.then(function(n){t.clearUser(),t.clearStorage(),e.localStorage.removeItem("user"),a.go("login")})["catch"](function(n){t.clearUser(),t.clearStorage(),e.localStorage.removeItem("user"),a.go("login")})},c.getCurrentUserId=function(){return t.currentUserId},c.getCurrentUserToken=function(){return t.accessTokenId},c.removeSatellizer=function(){e.localStorage.getItem("satellizer_token")&&e.localStorage.removeItem("satellizer_token")}}e.$inject=["$window","LoopBackAuth","Usuario","$state","$auth","appSettings","$http","$q"],angular.module("letsAngular").service("fwAuthService",e),e.inject=["$window","LoopBackAuth","Usuario","$state","$auth","appSettings","$http"]}(),function(){"use strict";function e(e){return{restrict:"A",scope:!0,link:function(t,n){t.defaultProgress=0,t.alreadySent=!1;var a=!0;window.setProgressFile=function(){void 0!=t.data[t.field.name]&&null!=t.data[t.field.name]&&t.fileName&&"fileName"!=t.fileName&&(t.defaultProgress=100,t.alreadySent=!0)},t.pushName=function(){e(function(){if(document.getElementsByClassName("dz-filename")[0]&&a){a=!1,document.getElementsByClassName("dropzone")[0].style.width="192px",document.getElementsByClassName("file-preview")[0]&&(document.getElementsByClassName("file-preview")[0].style.display="none"),document.getElementsByName("temp_filename")[0].value=document.getElementsByClassName("dz-filename")[0].firstElementChild.innerText;var e=n.find('input[type="hidden"]');e.controller("ngModel").$setViewValue(document.getElementsByName("temp_filename")[0].value)}})},t.remove=function(){t.alreadySent=!1;var e=n.find('input[type="hidden"]');document.getElementsByName("temp_filename")[0].value=null,e.controller("ngModel").$setViewValue(null)},t.upload=function(a,i){t.f=a,t.errFile=i&&i[0],a&&(a.upload=t._upload(t.field,a),a.upload.then(function(t){e(function(){a.result=t.data;var e=n.find('input[type="hidden"]');a.newName=t.data.result.files.file[0].name,e.controller("ngModel").$setViewValue(a.newName)})},function(e){e.status>0&&(t.errorMsg=e.status+": "+e.data)},function(e){a.progress=Math.min(100,parseInt(100*e.loaded/e.total))}))}}}}angular.module("letsAngular").directive("fwUpload",e),e.$inject=["$timeout"]}(),function(){"use strict";function e(){return{restrict:"E",scope:{tags:"="},template:'<div class="input-group fw-input-group"><input type="text" class="form-control" placeholder="add a tag..." ng-model="newValue" /> <span class="input-group-btn"><a class="btn btn-default" ng-click="add()">Add</a></span></div><div class="tags"><div ng-repeat="(idx, tag) in tags" class="tag label label-success">{{tag}} <a class="close" href ng-click="remove(idx)">×</a></div></div>',link:function(e,t){null==e.tags&&(e.tags=[]);var n=angular.element(t).find("input");e.autocomplete,e.add=function(){-1==e.tags.indexOf(e.newValue)&&e.tags.push(e.newValue),e.newValue=""},e.remove=function(t){e.tags.splice(t,1)},n.bind("keypress",function(t){13==t.keyCode&&(t.stopPropagation(),t.preventDefault(),e.$apply(e.add))})}}}angular.module("letsAngular").directive("fwTags",e),e.$inject=[]}(),function(){"use strict";angular.module("letsAngular").directive("numbersOnly",function(){return{require:"ngModel",link:function(e,t,n,a){function i(e){if(e){var t=e.replace(/[^0-9]/g,"");return t!==e&&(a.$setViewValue(t),a.$render()),t}return void 0}a.$parsers.push(i)}}})}(),function(){"use strict";function e(e,t,n,a,i){return{restrict:"E",scope:!0,templateUrl:"lets/views/framework/input.html",replace:!0,link:{pre:function(t,o,r,l){var s=o.attr("fw-data");if(void 0==t.field.customOptions.events&&(t.field.customOptions.events={}),t.fieldHtml=function(){return i.trustAsHtml(t.field.toString())},"data"!=s&&(t.data=t[s]),"detail_data"==s){var c=t.detail_key;t.field.autocomplete!==!1&&(t.autocomplete=function(e,n){return t.autocompleteDetail(c,e,n)},t.autocompleteSelect=function(e,n,a){return t.autocompleteDetailSelect(c,e,n,a)}),void 0!=t.field.customOptions.file&&(t.download=function(e,n){return t.downloadDetail(c,e,n,t.data)})}if(void 0!=t.field.customOptions.cep)o.find("input.main-input").blur(function(){var n=angular.element(this).scope();e.get(this.value).then(function(e){var a=n.field.customOptions.cep;n.data[a.address]=e.logradouro,n.data[a.district]=e.bairro,n.data[a.city]=e.localidade,n.data[a.state]=e.uf,t.$$phase||t.$apply()})});else if(void 0!=t.field.customOptions.multiple&&1==t.field.customOptions.multiple){n(o.contents())(t)}a(o).on("blur",":input[ng-model]",function(e){try{void 0!=angular.element(this).scope().field.customOptions.events.blur&&angular.element(this).scope().field.customOptions.events.blur.call(this,e)}catch(e){}}),t.isEmpty=function(e){return Object.keys(e).length}}}}}angular.module("letsAngular").directive("fwInput",e),e.$inject=["viaCEP","$timeout","$compile","jQuery","$sce"]}(),function(){"use strict";function e(e,t,n,a){return{restrict:"E",scope:!0,templateUrl:"lets/views/framework/input-detail.html",replace:!0,link:{post:function(e,t,n,a){}}}}angular.module("letsAngular").directive("fwInputDetail",e),e.$inject=["viaCEP","$timeout","$compile","jQuery"]}(),function(){"use strict";function e(e,t,n,a,i){return{restrict:"A",link:{post:function(n,i,o,r){if(r||(r=i.controller("ngModel")),"date"==n.field.type)i.mask("99/99/9999");else if(void 0!=n.field.customOptions.cpf)i.mask("999.999.999-99");else if(void 0!=n.field.customOptions.cnpj)i.mask("99.999.999/9999-99");else if("float"==n.field.type)void 0!=n.field.customOptions.currency&&(i.mask("#.##0,00",{reverse:!0}),r.$parsers.unshift(function(e){return parseFloat(i.cleanVal(),10)/100}),r.$formatters.unshift(function(e){return i.masked(e?parseFloat(e).toFixed(2):null)}));else if(void 0!==n.field.customOptions.documento){var l=function(e){return e.replace(/\D/g,"").length>=12?"00.000.000/0000-00":"000.000.000-009"},s={onKeyPress:function(e,t,n,a){n.mask(l.apply({},arguments),a)}};t(function(){i.mask(l,s)},10)}else if(void 0!=n.field.customOptions.telefone){var c=function(e){return 11===e.replace(/\D/g,"").length?"(00) 00000-0000":"(00) 0000-00009"},u={onKeyPress:function(e,t,n,a){n.mask(c.apply({},arguments),a)}};t(function(){i.mask(c,u)},100)}else void 0!=n.field.customOptions.cep&&i.blur(function(){if(!this.value)return!1;var t=angular.element(this).scope();a(this).parent().attr("fw-data");e.get(this.value).then(function(e){var n=t.field.customOptions.cep;t.data[n.address]=e.logradouro,t.data[n.district]=e.bairro,t.data[n.city]=e.localidade,t.data[n.state]=e.uf})})}}}}angular.module("letsAngular").directive("fwDynamic",e),e.$inject=["viaCEP","$timeout","$compile","jQuery","$filter"]}(),function(){"use strict";function e(e,t,n,a){return{restrict:"E",scope:!0,template:'<span">{{ formatData(detail_data, field) }}</span>',replace:!0,link:{pre:function(e,t,n,a){e.formatData=function(e,t){return t.autocomplete!==!1?e[t.name+".label"].label||e[t.name+".label"]:"boolean"==t.type&&t.customOptions.statusFalseText&&t.customOptions.statusTrueText?e[t.name]?t.customOptions.statusTrueText:t.customOptions.statusFalseText:e[t.name]}}}}}angular.module("letsAngular").directive("fwDetailData",e),e.$inject=["$timeout","$compile","jQuery","$sce"]}(),function(){"use strict";function e(e,t){var n="vm";return{restrict:"A",require:"?ngModel",scope:!0,terminal:!0,priority:1,compile:function(t,a){function i(e,n){var a=t.attr(e);angular.isDefined(a)&&a!==!1||t.attr(e,n)}var o=angular.element('<div class="input-group"><span class="input-group-btn"><button type="button" class="btn btn-default" ng-click="'+n+'.openPopup($event)"><i class="glyphicon glyphicon-calendar"></i></button></span></div>');return i("type","text"),i("is-open",n+".popupOpen"),i("show-button-bar",!1),i("show-weeks",!1),i("datepicker-options","datepickerOptions"),t.addClass("form-control"),t.removeAttr("fw-date-picker"),t.after(o),o.prepend(t),function(t,n){var i={};void 0===t.data&&(t.data={}),t.field?null!=t.data[t.field.name]&&(i.initDate=new Date(t.data[t.field.name]),t.data[t.field.name]=angular.copy(i.initDate)):(t.field={customOptions:[]},a.fwDatePickerNgModelParent?(i.initDate=new Date(t.$parent[a.ngModel]),t.$parent[a.ngModel]=angular.copy(i.initDate)):(i.initDate=new Date(t[a.ngModel]),t[a.ngModel]=angular.copy(i.initDate)));var o="dd/MM/yyyy";void 0!==t.field.customOptions.monthpicker&&(i.datepickerMode="'month'",i.minMode="month",o="MM/yyyy"),n.find("input").attr("datepicker-popup",o),n.find("input").blur(function(){moment(this.value,o).isValid()||""===this.value?t.field.error=!1:t.field.error=!0}),t.datepickerOptions=i,e(n)(t)}},controller:["$scope",function(e){this.popupOpen=!1,this.openPopup=function(e){e.preventDefault(),e.stopPropagation(),this.popupOpen=!0}}],controllerAs:n}}angular.module("letsAngular").directive("fwDatePicker",e),e.$inject=["$compile","jQuery"]}(),function(e,t){"function"==typeof define&&define.amd?define(["angular"],t):t(angular)}(this,function(e){function t(e){return{restrict:"A",require:["ckeditor","ngModel"],controller:["$scope","$element","$attrs","$parse","$q",n],link:function(t,n,i,o){var r=o[0],l=o[1];r.ready().then(function(){["dataReady","change","blur","saveSnapshot"].forEach(function(e){r.onCKEvent(e,function(){l.$setViewValue(r.instance.getData()||"")})}),r.instance.setReadOnly(!!i.readonly),i.$observe("readonly",function(e){r.instance.setReadOnly(!!e)}),a(function(){e(i.ready)(t)})}),l.$render=function(){r.ready().then(function(){r.instance.setData(l.$viewValue||"",{noSnapshot:!0,callback:function(){r.instance.fire("updateSnapshot")}})})}}}}function n(e,t,n,i,o){var r,l=i(n.ckeditor)(e)||{},s=t[0],c=o.defer();r=s.hasAttribute("contenteditable")&&"true"==s.getAttribute("contenteditable").toLowerCase()?this.instance=CKEDITOR.inline(s,l):this.instance=CKEDITOR.replace(s,l),this.onCKEvent=function(t,n){function i(){var e=arguments;a(function(){o.apply(null,e)})}function o(){var t=arguments;e.$apply(function(){n.apply(null,t)})}return r.on(t,i),function(){r.removeListener(t,o)}},this.onCKEvent("instanceReady",function(){c.resolve(!0)}),this.ready=function(){return c.promise},e.$on("$destroy",function(){c.promise.then(function(){r.destroy(!1)})})}e.module("ckeditor",[]).directive("ckeditor",["$parse",t]);var a=window&&window.setImmediate?window.setImmediate:function(e){setTimeout(e,0)}}),function(){"use strict";function e(e,t,n){return{restrict:"E",replace:!1,scope:{crudChartSettings:"&",crudChartData:"&"},templateUrl:"lets/views/framework/chart.html",controller:["$scope",function(a){var i=a.crudChartSettings(),o=i.chart_settings,r=a.crudChartData();a.key=i.key,a.d3chartUpdate=!1;var l=t.getMinMaxValues(o.xType,o.xLabel,o.xOffset,o.yType,o.yLabel,o.yOffset,r),s={x:[l.min.x,l.max.x],y:[l.min.y,l.max.y]};a.d3chartStartDate=l.min.x,a.d3chartEndDate=l.max.x,a.d3chartConfig=e.configD3chart("line",["#092e64"],s),a.d3chartData=e.configD3chartData(i.fillArea||!1,i.key,r),a.$watch("d3chartStartDate",function(t,i){l.min.x=t,s={x:[l.min.x,l.max.x],y:[l.min.y,l.max.y]},a.d3chartConfig=e.configD3chart("line",["#092e64"],s),t!=i&&n.$broadcast("update-chart",{type:"filter"})}),a.$watch("d3chartEndDate",function(t,i){l.max.x=t,s={x:[l.min.x,l.max.x],y:[l.min.y,l.max.y]},a.d3chartConfig=e.configD3chart("line",["#092e64"],s),t!=i&&n.$broadcast("update-chart",{type:"filter"})})}],link:function(e,t,n,a,i){e.$el=t}}}angular.module("letsAngular").directive("fwChart",e),e.$inject=["fwChartService","fwComparatorService","$rootScope"]}(),function(){"use strict";function e(e,t){var n="vm";return{restrict:"A",priority:1,link:function(e,n){var a=n.find("input"),i=function(){var e=a.val(),n=e+" ";a.controller("ngModel").$setViewValue(n),t(function(){a.controller("ngModel").$setViewValue(e)})};n.find("button").click(i),a.click(i),a.keyup(function(){""==this.value.trim()&&delete a.scope().data[a.attr("name")]})},controller:function(){},controllerAs:n}}angular.module("letsAngular").directive("fwAutoComplete",e),e.$inject=["$compile","$timeout"]}(),function(){"use strict";function e(e,t,n,a){var i="vm";return{restrict:"A",priority:1,link:function(e,a){var i=e;i.tableSelected=function(e,t,n){i.tableVisibily=!1;var a=e.currentTarget.firstElementChild.firstChild.data.trim();i.data[t]=n.id,i.data[t+".labelCopy"]={id:n.id,label:a},i.data[t+".label"]=a},i.loadDataAutoCompleteTable=function(e,o){var r=a.find(":input").val().split(" "),l="/^("+r[0]+")";r.splice(0,1),r.forEach(function(e){l+="(?=.*"+e+")"}),l+=".*/i";var s='{"limit": 5,"where":{"'+o+'":{"regexp":"'+l+'"}}}',c=t.appSettings.API_URL+e+"?filter="+s,u=t.appSettings.API_URL+e+"/crudGET/";n.get(c).then(function(e){i.autoCompleteTableData2=[],e.data.forEach(function(e){n.get(u+e.id).then(function(e){i.autoCompleteTableData2.push(e.data)})})})}},controller:["$scope",function(e){e.autoCompleteTableFocus=function(t){e.tableVisibily=!0},e.autoCompleteTableLostFocus=function(){setTimeout(function(){e.$apply(function(){e.tableVisibily=!1})},100)},e.updateAutoCompleteTable=function(t,n){e.loadDataAutoCompleteTable(t,n)}}],controllerAs:i}}angular.module("letsAngular").directive("fwAutoCompleteTable",e),e.$inject=["$compile","$rootScope","$http","$timeout"]}(),function(){"use strict";function e(e){return{scope:{crudTabListData:"=",crudTabListSettings:"&",parentData:"="},templateUrl:"lets/views/crud/crud-tab-list.html",link:function(e,t){setTimeout(function(){var t=e.crudTabListSettings();e.data=e.parentData,e.type=t.type,e.headers=t.headers,e.app=e.$parent.app,e.crudTabListData&&(e.extraData=e.crudTabListData)},1e3)}}}angular.module("letsAngular").directive("crudTabList",e),e.$inject=["jQuery"]}(),function(){"use strict";function e(e,t,n,a,i,o){return{scope:{crudListSettings:"&",crudListDependenciesData:"&",app:"="},controller:["$scope",function(e){e.route=null,e.$on("refreshGRID",function(t,n){e.pageableCRUDModel.fetch(n)})}],link:function(o,r,l){function s(){function r(e){function n(){return l.fields[1]&&"string"===l.fields[1].type?d.render().sort(l.fields[1].name,"ascending").$el:d.render().$el}var i=[],r=function(){};r.prototype=new a.StringFormatter,_.extend(r.prototype,{fromRaw:function(e,t,n,a,i){return e}}),_.each(l.fields,function(e,t){if(e.viewable){var n={name:e.name,label:e.label,cell:"string",editable:!1,headers:e};if("boolean"==e.type)n.sortable=!1,n.cell=a.Cell.extend({className:"custom-situation-cell",formatter:{fromRaw:function(t,n){return t?e.customOptions.statusTrueText:e.customOptions.statusFalseText},toRaw:function(e,t){return"down"}}});else if("simplecolor"==e.type)n.sortable=!1,n.cell=a.Cell.extend({className:"custom-situation-cell",initialize:function(){a.Cell.prototype.initialize.apply(this,arguments)},render:function(){this.$el.empty();var e='<cp-color class="color-picker" style="background-color: '+this.model.attributes.cor+'"></cp-color>';return this.$el.append(e),this.delegateEvents(),this}});else if("custom"==e.type){var o={fromRaw:e.toString,toRaw:function(e,t){return"down"}};n.sortable=!1;var r=a.Cell.extend({className:"custom-cell",formatter:o});r.initialize=function(){a.Cell.prototype.initialize.apply(this,arguments)},r.render=function(){this.$el.empty(),this.$el.data("model",this.model);var e=o.fromRaw(this.model);return this.$el.append(e),this.delegateEvents(),this},n.cell=a.Cell.extend(r)}else if("address"==e.type){var l={fromRaw:function(e,t){try{return e.city+" - "+e.state}catch(n){return""}},toRaw:function(e,t){return"down"}},s=a.Cell.extend({className:"address-cell",formatter:l});n.cell=s}else if("float"==e.type)n.cell=a.NumberCell.extend({decimalSeparator:",",orderSeparator:"."});else if("date"==e.type){var c="DD/MM/YYYY";void 0!==e.customOptions.monthpicker&&(c="MM/YYYY"),n.cell=a.Extension.MomentCell.extend({modelFormat:"YYYY/M/D",displayLang:"pt-br",displayFormat:c})}else if(void 0!=e.customOptions["enum"]){var u=[];for(var d in e.customOptions["enum"]){var f=e.customOptions["enum"][d];u.push([f,d])}n.cell=a.SelectCell.extend({optionValues:u})}else 1==e.autocomplete&&(e.customOptions&&void 0!=e.customOptions.list?n.cell=a.Cell.extend({className:"custom-situation-cell-select",formatter:{fromRaw:function(t,n){var a="";return e.customOptions.list.forEach(function(e){e.id==t&&(a=e.label)}),a},toRaw:function(e,t){return"down"}}}):n.name=n.name+".label");i.push(n)}});var s=a.Cell.extend({className:"text-right btn-column"+(1==l.tab?" detail":""),template:function(){var e=[];if(l.tab)if(l.settings){if(l.settings.edit){var n=t('<button type="button" class="btn btn-default btn-edit-detail"><span class="glyphicon glyphicon-pencil"></span></button>');n.attr("data-route",l.url),e.push(n)}if(l.settings["delete"]){var a=t('<button type="button" class="btn btn-default btn-delete-detail"><span class="glyphicon glyphicon-remove"></span></button>');a.attr("data-route",l.url),e.push(a)}}else{var a=t('<button type="button" class="btn btn-default btn-delete-detail"><span class="glyphicon glyphicon-remove"></span></button>');a.attr("data-route",l.url),e.push(a)}else l.settings.edit&&e.push(t('<button type="button" class="btn btn-default btn-edit"><span class="glyphicon glyphicon-pencil"></span></button>')),l.settings["delete"]&&e.push(t('<button type="button" class="btn btn-default btn-delete"><span class="glyphicon glyphicon-remove"></span></button>'));var i=t('<div class="btn-group" role="group">');return i.append(e),i},events:{},editRow:function(e){e.preventDefault()},render:function(){var e=this.template(this.model.toJSON());return this.$el.html(e),this.$el.data("model",this.model),this.$el.find("button.btn-edit").click(function(e){e.stopPropagation();var t=angular.element(this).scope();l.tab?t.$parent.edit($(this).closest("td").data("model").attributes):t.edit($(this).closest("td").data("model").attributes)}),this.$el.find("button.btn-delete").click(function(e){e.stopPropagation();var t=window.confirm("Deseja realmente excluir esse registro?");if(t){var n=angular.element(this).scope();l.tab?n.$parent["delete"]($(this).closest("td").data("model").attributes):n["delete"]($(this).closest("td").data("model").attributes);
}}),this.$el.find("button.btn-delete-detail").click(function(e){e.stopPropagation();var n=window.confirm("Deseja realmente excluir esse registro?");if(n){var a=angular.element(this).scope(),i=t(this).attr("data-route");l.tab?a.$parent.deleteDetail(i,$(this).closest("td").data("model").attributes):a.deleteDetail(i,$(this).closest("td").data("model").attributes)}}),this.$el.find("button.btn-edit-detail").click(function(e){e.stopPropagation();var t=angular.element(this).scope(),n=$.parseJSON($(this).closest(".table-container").attr("tab-config")),a=$(this).closest("td").data("model").attributes,i=$(this).attr("data-route");t.newDetail(n,t.data,a.id,i)}),this.delegateEvents(),this}});i.push({name:"actions",label:"Ações",sortable:!1,cell:s}),o.$parent.app.helpers.isScreen("xs")&&i.splice(3,1);var c=[];1==l.tab&&c.push("detail"),void 0==l.settings||l.settings.edit||c.push("cant-edit");var u=a.Row.extend({className:c.join(" ")}),d=new a.Grid({row:u,columns:i,collection:e,className:"table table-striped table-editable no-margin mb-sm"}),f=new a.Extension.Paginator({slideScale:.25,goBackFirstOnSort:!1,collection:e,controls:{rewind:{label:'<i class="fa fa-angle-double-left fa-lg"></i>',title:"First"},back:{label:'<i class="fa fa-angle-left fa-lg"></i>',title:"Previous"},forward:{label:'<i class="fa fa-angle-right fa-lg"></i>',title:"Next"},fastForward:{label:'<i class="fa fa-angle-double-right fa-lg"></i>',title:"Last"}}});o.$el.find(".table-container").html("").append(n()).append(f.render().$el)}var l=o.crudListSettings();l.route=i.API_URL+l.url,o.route=l.route,a.InputCellEditor.prototype.attributes["class"]="form-control input-sm";var s=n.Model.extend({}),c={model:s,url:l.route+(l.pagerGeneral?"/pagerGeneral":"/pager"),state:{pageSize:20},mode:"server",parseRecords:function(e,t){return e.data},parseState:function(e,t,n,a){return{totalRecords:e.total_count}}};l.filterScope&&(c.queryParams={scope:l.filterScope}),l.sort&&(c.state.sortKey=l.sort.sortKey,l.sort.order&&"desc"==l.sort.order&&(c.state.order=1));var u=n.PageableCollection.extend(c),d=new u;o.pageableCRUDModel=d,t(e).on("sn:resize",function(){r(d)}),r(d),o.$broadcast("refreshGRID")}o.$el=r;var c=o.$parent.$watch("headers",function(e,t){if(null!=e){var n=o.crudListSettings();if(1==n.tab)var a=o.$parent.$watch("data",function(e,t){void 0!=e.id&&(s(),a(),c())});else s(),c()}})}}}angular.module("letsAngular").directive("crudList",e),e.$inject=["$window","jQuery","Backbone","Backgrid","appSettings","fwObjectService"]}(),function(){"use strict";function e(e,t,n){return{replace:!1,link:function(a,i){for(var o in a.headers.fields){var r=a.headers.fields[o];r.customOptions.file&&(a.dzOptions={url:n.API_URL+"upload/"+r.customOptions.file.container+"/upload",acceptedFiles:r.customOptions.file.acceptedFiles,maxFilesize:"25",maxFiles:"1",uploadMultiple:!1,addRemoveLinks:!0})}a.dzMethods={},a.removeNewFile=function(){a.dzMethods.removeFile(a.newFile)},e(i).on("click",".button-new",function(){var t=e(this).attr("detail"),n=e(this).attr("origin"),i="true"==e(this).attr("form-modal");a.newDetailData(n,t,i)}),t(function(){i.find(".tab-group .nav-tabs li:first").find("a").click(),i.find(':input[type!="hidden"]:first').focus()},500),$(i).parsley({priorityEnabled:!1,errorsContainer:function(e){return e.$element.closest(".input-container")}})}}}angular.module("letsAngular").directive("crudForm",e),e.$inject=["jQuery","$timeout","appSettings"]}(),function(){"use strict";function e(e,t,n,a){return{templateUrl:"lets/views/crud/crud-filter.html",replace:!0,scope:{fields:"&",route:"&"},controller:["$scope",function(e){e.data={}}],link:function(i,o){var r=angular.copy(i.fields());i.fieldsFilter=[],r.forEach(function(e,t){"custom"!=e.type&&"id"!=e.name&&"password"!=e.type&&(e.disabled=!1,e.notnull=!1,e.name=e.name,e.customOptions.file&&delete e.customOptions.file,"text"==e.type&&(e.type="string"),"boolean"==e.type&&(e.type="number",e.autocomplete=!0,e.customOptions={list:[{id:"false",label:e.customOptions.statusFalseText},{id:"true",label:e.customOptions.statusTrueText}],select:!0}),i.fieldsFilter.push(e))}),i.autocomplete=function(n,a){i.resource=t.all(i.route());var o=[],r=e.defer();if(n.autocomplete_dependencies.length>0){var l=n.autocomplete_dependencies;for(var s in l){var c=l[s];if(void 0==i.data[c.field]||null==i.data[c.field]){var u="Selecione antes o(a) "+c.label,d=[];return d.push({id:null,label:u}),r.resolve(d),r.promise}o[c.field]=i.data[c.field]}}if(a=a.trim(),(0==a.length||1==n.customOptions.select)&&(a="[blank]"),void 0!==n.customOptions.general)i.resource.customGET("general/autocomplete/"+n.customOptions.general+"/"+a,o).then(function(e){r.resolve(e)},function(){return r.reject()});else if(void 0==n.customOptions.list){var f="autocomplete/"+n.name+"/"+a;1==n.customOptions.select?o.limit=0:o.limit=20,i.resource.customGET(f,o).then(function(e){1==n.customOptions.select&&e.unshift({id:null,label:"--- Selecione ---"}),r.resolve(e)},function(){return r.reject()})}else{var m=angular.copy(n.customOptions.list)||[];1==n.customOptions.select&&m.unshift({id:null,label:"--- Selecione ---"}),r.resolve(m)}return r.promise},i.autocompleteSelect=function(e,t,a){var i=this.data;if(void 0==i&&(i={}),null!=e.id&&"integer"!=typeof e.id||"integer"==typeof e.id&&e.id>0)i[this.field.name]=e.id;else{if(null!=e.id)return i[this.field.name+".label"]=null,!1;i[this.field.name]=i[this.field.name+".label"]=null}this.data=i;var o=this.field;n(function(){jQuery("#"+o.name).trigger("keyup")})},i.filterData=function(){var e={};i.showBuscaAvancada?(r.forEach(function(t,n){i.data[t.name]&&(e[t.name]=i.data[t.name])}),a.$broadcast("refreshGRID",{data:{filter:e}})):(e.q=i.data.q,a.$broadcast("refreshGRID",{data:e}))},i.openBuscaAvancada=function(){i.showBuscaAvancada=!i.showBuscaAvancada,i.filterData()}}}}angular.module("letsAngular").directive("crudFilter",e),e.$inject=["$q","Restangular","$timeout","$rootScope"]}(),function(){"use strict";function e(){return{restrict:"E",templateUrl:"lets/views/framework/breadcrumb.html",replace:!0,link:function(e,t){}}}angular.module("letsAngular").directive("crudBreadcrumb",e),e.$inject=[]}(),function(){"use strict";function e(e){this.$get=e.$get,this.state=e.state,this.setCRUDRoutes=function(e){var t={main:{enable:!0,templateUrl:"lets/views/crud/crud.html",controller:"CRUDController"},list:{enable:!0,templateUrl:"lets/views/crud/crud-list.html"},edit:{enable:!0,templateUrl:"lets/views/crud/crud-edit.html",controller:"CRUDEditController"},"new":{enable:!0,templateUrl:"lets/views/crud/crud-edit.html",controller:"CRUDEditController"}},n=angular.merge(t,e.options);n.main.enable&&this.state("app."+e.route,{"abstract":!0,url:"/"+e.route,templateUrl:n.main.templateUrl,controller:n.main.controller,resolve:{id:["$stateParams",function(e){return e.id}],module:function(){return e.modelName}}}),n.list.enable&&this.state("app."+e.route+".list",{url:"",templateUrl:n.list.templateUrl}),n["new"].enable&&this.state("app."+e.route+".new",{url:"/new",templateUrl:n["new"].templateUrl,controller:n["new"].controller}),n.edit.enable&&this.state("app."+e.route+".edit",{url:"/:id/edit",templateUrl:n.edit.templateUrl,controller:n.edit.controller})}}e.$inject=["$stateProvider"],angular.module("letsAngular").provider("fwState",e)}(),function(){"use strict";function e(){this.$get=["$templateRequest",function(e){return new t(e)}]}function t(e){var t=this;return t.getCrudBaseTemplate=function(){return e("lets/views/crud/crud.html")},t.getCrudListTemplate=function(){return e("lets/views/crud/crud-list.html")},t.getCrudEditTemplate=function(){return e("lets/views/crud/crud-edit.html")},{getCrudBaseTemplate:t.getCrudBaseTemplate,getCrudListTemplate:t.getCrudListTemplate,getCrudEditTemplate:t.getCrudEditTemplate}}angular.module("letsAngular").provider("fwFileLoad",e)}(),function(){"use strict";function e(e){if(null!=e){"string"==typeof e&&(e=new Date(e));var t=" meses",n=moment(e),a=moment().diff(n,"months");return a?a>12&&(t=" anos",a=moment().diff(n,"years")):(t=" dias",a=moment().diff(n,"days")),a+t}}e.$inject=["birthday"],angular.module("letsAngular").filter("fwAgeMonth",e)}(),function(){"use strict";function e(e){return e.Backgrid}angular.module("letsAngular").factory("Backgrid",e),e.$inject=["$window"]}(),function(){"use strict";function e(e){return e.Backbone}angular.module("letsAngular").factory("Backbone",e),e.$inject=["$window"]}(),function(){"use strict";var e=angular.module("letsAngular");e.controller("CRUDController",["$scope","Restangular","module","$state","$window","$stateParams","$rootScope","headers",function(e,t,n,a,i,o,r,l){function s(){var t=angular.copy(l.get(n));e.headers=t}e.headersReady=!1,s(),e.$on("refresh-headers",function(){s()}),e.resource=t.all(e.headers.route),e.$broadcast("headers-set"),e.headersReady=!0,e.goNew=function(){a.go(a.current.name.replace(".list",".new"))},e.goToList=function(){-1==a.current.name.indexOf(".list")&&a.go(a.current.name.replace(".edit",".list").replace(".new",".list"))},e.edit=function(e){a.go(a.current.name.replace(/\.list$/,".edit"),{id:e.id,page:null})},e["delete"]=function(t){return e.resource.customDELETE(t.id).then(function(){r.$broadcast("refreshGRID")})}}])}(),function(){"use strict";var e=angular.module("letsAngular");e.controller("CRUDFormModalController",["$controller","$scope","$modalInstance","ngToast","headers","Restangular","$stateParams","$timeout","$state","$rootScope","$q","$http","Upload","$modal","data","fwStringService","auth","fwObjectService","fwErrorService",function(t,n,a,i,o,r,l,s,c,u,d,f,m,p,h,g,v,y,b){t("CRUDEditController",{$scope:n,Restangular:r,$stateParams:l,$timeout:s,$modal:p,module:e,$state:c,$rootScope:u,$q:d,ngToast:i,$http:f,Upload:m}),n.data=h||{},n.headers=o,n.resource=r.all(o.route);for(var w in n.headers.fields){var D=n.headers.fields[w];"boolean"==D.type&&void 0==n.data[D.name]&&(D.customOptions["default"]?n.data[D.name]=!0:n.data[D.name]=!1)}o.modal_id&&u.$emit("open:"+o.modal_id,n),n.cancel=function(){a.dismiss("cancel")},n.submit=function(){this.crudForm.$valid?a.close(n.data):b.emitFormErrors(this.crudForm)},u.$on("cancel-modal",function(e,t){a.dismiss("cancel")}),s(function(){"function"==typeof window.setProgressFile&&window.setProgressFile()})}])}(),function(){"use strict";var e=angular.module("letsAngular");e.controller("CRUDEditController",["$scope","Restangular","$stateParams","$timeout","$modal","module","$state","$rootScope","$q","ngToast","$http","Upload","fwModalService",function(e,t,n,a,i,o,r,l,s,c,u,d,f){e.data={},e.dataLoaded=!1,e.module=o,e.$http=u,e.$emit("refresh-headers"),e.datepickers={},e.datepickerToggle=function(t){void 0==e.datepickers[t]&&(e.datepickers[t]=!1),e.datepickers[t]=!e.datepickers[t]},e.fetchData=function(){if(n.id)e.$parent.resource.customGET("crudGET/"+n.id).then(function(t){for(var n in e.headers.fields){var i=e.headers.fields[n];"date"==i.type&&void 0!=t[i.name]&&null!=t[i.name]&&(t[i.name]=new Date(t[i.name])),i.customOptions&&void 0!=i.customOptions.list&&i.customOptions.list.forEach(function(e){e.id==t[i.name]&&(t[i.name+".label"]=e.label)}),i.customOptions&&void 0!=i.customOptions.file&&(e.fileName=t[i.name])}e.data=t,e.dataLoaded=!0,"function"==typeof window.setProgressFile&&a(function(){window.setProgressFile()}),e.$emit("data-loaded")});else{a(function(){e.$emit("data-new")},50);for(var t in e.headers.fields){var i=e.headers.fields[t];"boolean"==i.type&&(e.data[i.name]=i.customOptions["default"]?i.customOptions["default"]:!1)}e.dataLoaded=!0,e.$emit("data-loaded")}},e.headersReady&&e.fetchData(),e.$on("headers-set",function(){e.fetchData()}),e._upload=function(e,t){var n=l.appSettings.API_URL+"upload";return void 0!=e.customOptions.file.container&&(n+="/"+e.customOptions.file.container+"/upload"),d.upload({url:n,data:{file:t}})},e.download=function(t,n){if(void 0!=t.customOptions.file.container)var a=l.appSettings.API_URL+"upload/"+t.customOptions.file.container+"/download/"+e.data[t.name];else var a=l.appSettings.API_URL+e.module+"/download/"+t.name+"/"+n;e._download(a,t,e.data)},e.downloadDetail=function(t,n,a,i){if(void 0!=n.customOptions.file.container)var o=l.appSettings.API_URL+"upload/"+n.customOptions.file.container+"/download/"+i[n.name];else var o=l.appSettings.API_URL+e.module+"/details/"+t+"/download/"+n.name+"/"+a;e._download(o,n,i)},e._download=function(t,n,a){this.$http({method:"GET",url:t,responseType:"arraybuffer"}).success(function(t,i,o){if(o=o(),void 0!=n.customOptions.file.container)var r=a[n.name];else var r=o["content-disposition"].split(";")[1].split("=")[1].split('"')[1];var l=o["content-type"],s=new Blob([t],{type:l});e.downloadFile(s,r)})},e.downloadFile=function(e,t){var n=document.createElement("a");try{var a=window.URL.createObjectURL(e);n.setAttribute("href",a),n.setAttribute("download",t);var i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});n.dispatchEvent(i)}catch(o){}},e.submit=function(){var t=this,a={},i=t.data;if(_.each(t.headers.fields,function(e,t){"password"==e.type&&0!=e.name.indexOf("confirm")&&i["confirm_"+e.name]!=i[e.name]&&(a.password='Os campos "'+e.label+'" e "Confirmar '+e.label+'" não são iguais')}),_.each(t.data,function(e,t){-1!==t.indexOf(".label")&&void 0===i.id&&"object"!=typeof e&&""!==e&&(a[t]="Adicione o(a) "+t.split(".")[0]+" no sistema antes de escolher nesse formulário!"),"data_nascimento"===t&&(moment(e).isAfter(moment())||moment(e).isSame(moment(),"day"))&&(a[t]="Insira uma data de nascimento válida, anterior ao dia de hoje!")}),Object.keys(a).length>0){var o=new Array;_.each(a,function(e,t){o.push(e)}),c.warning(o.join("<br />"))}else if(this.crudForm.$valid){if(t.headers.tabs&&Object.keys(t.headers.tabs).forEach(function(e){t.data[e]&&delete t.data[e]}),n.id)var l=e.data.put(),s="edit";else var l=e.$parent.resource.post(e.data),s="new";l.then(function(t){void 0!=e.doAfterSave&&"function"==typeof e.doAfterSave?e.doAfterSave(t,s):r.go(r.current.name.replace(".edit",".list").replace(".new",".list"))},function(e){function n(e){for(var n in t.headers.fields){var a=t.headers.fields[n];if(a.name==e)return a.label}}var a=[];if(422==e.status)if("CANT_SAVE_MODEL"==e.data.error.code)a.push(e.data.error.message);else{var i=e.data.error.details.codes,o={presence:"O campo %s é obrigatório",absence:"O campo %s deve ser nulo","unknown-property":"O campo %s não foi definido",length:{min:"O campo %s é muito curto",max:"O campo %s é muito longo",is:"O campo %s está com tamanho inválido"},common:{blank:"O campo %s está em branco","null":"O campo %s está nulo"},numericality:{"int":"O campo %s não é um número inteiro",number:"O campo %s não é um número"},inclusion:"O campo %s não foi incluído na lista",exclusion:"O campo %s não pode ser excluído",uniqueness:"O campo %s está repetido com o de outro registro"};_.each(i,function(e,t){var i=n(t),r=o[e].replace("%s",i);a.push(r)})}c.warning(a.join("<br />"))})}else{var u=[],d=Object.keys(this.crudForm.$error),f=/^([0-9]{2})\/([0-9]{2})\/([0-9]{4})$/;for(var m in d){var p=this.crudForm.$error[d[m]];for(var h in p){var g=p[h].$options.fieldInfo.label;"required"==d[m]?u.push("O campo "+g+" é obrigatório"):"date"==d[m]&&0==f.test(p[h].$viewValue)&&u.push("O campo "+g+" está com uma data inválida")}}if(u.length>0)c.warning(u.join("<br />"));else{if(n.id)var l=e.data.put(),s="edit";else var l=e.$parent.resource.post(e.data),s="new";l.then(function(){void 0!=e.doAfterSave&&"function"==typeof e.doAfterSave?e.doAfterSave(resp,s):r.go(r.current.name.replace(".edit",".list").replace(".new",".list"))},function(e){function n(e){for(var n in t.headers.fields){var a=t.headers.fields[n];if(a.name==e)return a.label}}var a=[];if(422==e.status)if("CANT_SAVE_MODEL"==e.data.error.code)a.push(e.data.error.message);else{var i=e.data.error.details.codes,o={presence:"O campo %s é obrigatório",absence:"O campo %s deve ser nulo","unknown-property":"O campo %s não foi definido",length:{min:"O campo %s é muito curto",max:"O campo %s é muito longo",is:"O campo %s está com tamanho inválido"},common:{blank:"O campo %s está em branco","null":"O campo %s está nulo"},numericality:{"int":"O campo %s não é um número inteiro",number:"O campo %s não é um número"},inclusion:"O campo %s não foi incluído na lista",exclusion:"O campo %s não pode ser excluído",uniqueness:"O campo %s está repetido com o de outro registro"};_.each(i,function(e,t){var i=n(t),r=o[e].replace("%s",i);a.push(r)})}c.warning(a.join("<br />"))})}}},e.cancel=function(){r.go(r.current.name.replace(".edit",".list").replace(".new",".list"))},e.autocompleteModels={},e.autocompleteAdd=function(e){},e._autocomplete=function(t,n,a){var i=[],o=s.defer();if(t.autocomplete_dependencies.length>0){var r=t.autocomplete_dependencies;for(var l in r){var c=r[l];if(void 0==e.data[c.field]||null==e.data[c.field]){var u="Selecione antes o(a) "+c.label,d=[];return d.push({id:null,label:u}),o.resolve(d),o.promise}i[c.field]=e.data[c.field]}}if(n=n.trim(),(0==n.length||1==t.customOptions.select)&&(n="[blank]"),void 0!==t.customOptions.general)e.resource.customGET("general/autocomplete/"+t.customOptions.general+"/"+n,i).then(function(e){t.quickAdd===!0&&"[blank]"!=n&&e.push({id:-1,label:"Adicionar novo: "+n}),o.resolve(e)},function(){return o.reject()});else if(void 0==t.customOptions.list){if(a)var f="details/"+a+"/autocomplete/"+t.name+"/"+n;else var f="autocomplete/"+t.name+"/"+n;1==t.customOptions.select?i.limit=0:i.limit=20,e.resource.customGET(f,i).then(function(e){1==t.customOptions.select&&e.unshift({id:null,label:"--- Selecione ---"}),t.quickAdd===!0&&"[blank]"!=n&&e.push({id:-1,label:"Adicionar novo: "+n}),o.resolve(e)},function(){return o.reject()})}else{var m=angular.copy(t.customOptions.list)||[];1==t.customOptions.select&&m.unshift({id:null,label:"--- Selecione ---"}),o.resolve(m)}return o.promise},e.autocomplete=function(e,t){return this._autocomplete(e,t,null)},e.autocompleteDetail=function(e,t,n){return this._autocomplete(t,n,e)},e.doafterAutoCompleteSelect={},e._autocompleteSelect=function(t,n,i,o){var r=o?this.detail_data:this.data;if(void 0==r&&(r={}),null!=t.id&&"integer"!=typeof t.id||"integer"==typeof t.id&&t.id>0)r[this.field.name]=t.id;else{if(null!=t.id)return r[this.field.name+".label"]=null,!1;r[this.field.name]=r[this.field.name+".label"]=null}"function"==typeof e.doafterAutoCompleteSelect[this.field.name]&&e.doafterAutoCompleteSelect[this.field.name].call(this,r,t,n,i),o?this.detail_data=r:this.data=r;var l=this.field;a(function(){jQuery("#"+l.name).trigger("keyup")})},e.autocompleteSelect=function(e,t,n,a){this._autocompleteSelect(t,n,a,null)},e.autocompleteDetailSelect=function(e,t,n,a){this._autocompleteSelect(t,n,a,e)},e.openPopup=function(e){e.preventDefault(),e.stopPropagation(),this.popupOpen=!0},e.buttonClick=function(t){e[t]()},e.newDetail=function(t,n,a,i){e.headers.parent_route?e.headers.parent_route:e.headers.route.toLowerCase();t.route=a?i:o+t.route,t.id=a?a:null,f.createCRUDModal(t,null,"CRUDEditDetailController")},e.deleteDetail=function(e,n){var a=t.all(e);a.customDELETE(n.id).then(function(){l.$broadcast("refreshGRID"),l.$broadcast("data-grid-updated",{type:e.split("/").pop()})})},e.newDetailData=function(t,n,a){if(e.data[n]=e.data[n]||[],a){var i=e.headers[t][n];i.route_detail?i.route=i.route_detail:i.route=e.headers.route+"/details/"+n,f.createCRUDModal(i).then(function(t){t["new"]=!0,e.data[n].push(t)})}else{var o={},r=e.headers[t][n].fields;for(var l in r)"boolean"!=r[l].type?o[r[l].name]=null:o[r[l].name]=!1;o["new"]=!0,e.data[n].push(o),e.$apply()}},e.editDetailData=function(t,n,a){var i=e.headers[t][n];i.route_detail?i.route=i.route_detail:i.route=e.headers.route+"/details/"+n,f.createCRUDModal(i,a).then(function(t){e.data[n][e.data[n].indexOf(a)]=t})},e.deleteDetailData=function(e,t){window.confirm("Deseja realmente excluir esse item?")&&this.data[t].splice(this.data[t].indexOf(e),1)}}])}(),function(){"use strict";var e=angular.module("letsAngular");e.controller("CRUDEditDetailController",["$scope","Restangular","$http","$stateParams","$timeout","headers","$rootScope","$modalInstance","$q","ngToast","Upload",function(e,t,n,a,i,o,r,l,s,c,u){e.data={},e.headers=o,e.resource=t.all(o.route),e.autocompleteModels={},e.doafterAutoCompleteSelect={},e.$http=n,e.datepickers={},e.datepickerToggle=function(t){void 0==e.datepickers[t]&&(e.datepickers[t]=!1),e.datepickers[t]=!e.datepickers[t]};for(var d in e.headers.fields){var f=e.headers.fields[d];"boolean"==f.type&&(e.data[f.name]=!1)}o.id?e.resource.customGET(o.id).then(function(t){for(var n in e.headers.fields){var a=e.headers.fields[n];"date"==a.type&&void 0!=t[a.name]&&null!=t[a.name]&&(t[a.name]=new Date(t[a.name])),a.customOptions&&void 0!=a.customOptions.list&&a.customOptions.list.forEach(function(e){e.id==t[a.name]&&(t[a.name+".label"]=e.label)})}e.data=t,"function"==typeof window.setProgressFile&&i(function(){window.setProgressFile()}),e.$emit("data-loaded-detail")}):i(function(){e.$emit("data-new-detail")},50),i(function(){e.submit=function(){if(this.crudForm.$valid){if(e.data.id)var t=e.resource.customPUT(e.data,e.data.id);else var t=e.resource.customPOST(e.data,a.id);t.then(function(){r.$broadcast("refreshGRID"),l.dismiss("success")},function(e){var t=[];for(var n in e.data)for(var a in e.data[n])t.push(e.data[n][a]);c.warning(t.join("<br />"))})}},e.cancel=function(){l.dismiss("success")},e._upload=function(e,t){var n=r.appSettings.API_URL+"upload";return void 0!=e.customOptions.file.container&&(n+="/"+e.customOptions.file.container+"/upload"),u.upload({url:n,data:{file:t}})},e.download=function(t,n){if(void 0!=t.customOptions.file.container)var a=r.appSettings.API_URL+"upload/"+t.customOptions.file.container+"/download/"+e.data[t.name];else var a=r.appSettings.API_URL+e.module+"/download/"+t.name+"/"+n;e._download(a,t,e.data)},e.downloadDetail=function(t,n,a,i){if(void 0!=n.customOptions.file.container)var o=r.appSettings.API_URL+"upload/"+n.customOptions.file.container+"/download/"+i[n.name];else var o=r.appSettings.API_URL+e.module+"/details/"+t+"/download/"+n.name+"/"+a;e._download(o,n,i)},e._download=function(t,n,a){this.$http({method:"GET",url:t,responseType:"arraybuffer"}).success(function(t,i,o){if(o=o(),void 0!=n.customOptions.file.container)var r=a[n.name];else var r=o["content-disposition"].split(";")[1].split("=")[1].split('"')[1];var l=o["content-type"],s=new Blob([t],{type:l});e.downloadFile(s,r)})},e.downloadFile=function(e,t){var n=document.createElement("a");try{var a=window.URL.createObjectURL(e);n.setAttribute("href",a),n.setAttribute("download",t);var i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});n.dispatchEvent(i)}catch(o){}},e._autocomplete=function(t,n,a){var i=[],o=s.defer();if(t.autocomplete_dependencies.length>0){var r=t.autocomplete_dependencies;for(var l in r){var c=r[l];if(void 0==e.data[c.field]||null==e.data[c.field]){var u="Selecione o "+c.label,d=[];return d.push({id:null,label:u}),o.resolve(d),o.promise}e.data[c.field].id?i[c.field]=e.data[c.field].id:i[c.field]=e.data[c.field]}}if(n=n.trim(),(0==n.length||1==t.customOptions.select)&&(n="[blank]"),void 0==t.customOptions.list){var f="autocomplete/"+t.name+"/"+n;1==t.customOptions.select?i.limit=0:i.limit=20,e.resource.customGET(f,i).then(function(e){1==t.customOptions.select&&e.unshift({id:null,label:"--- Selecione ---"}),t.quickAdd===!0&&"[blank]"!=n&&e.push({id:null,label:"Adicionar novo: "+n}),o.resolve(e)},function(){return o.reject()})}else{var m=angular.copy(t.customOptions.list)||[];1==t.customOptions.select&&m.unshift({id:null,label:"--- Selecione ---"}),o.resolve(m)}return o.promise},e._autocompleteSelect=function(t,n,a,o){if(null!=t.id&&"integer"!=typeof t.id||"integer"==typeof t.id&&t.id>0)this.data[this.field.name]=t.id;else{if(null!=t.id)return this.data[this.field.name+".label"]=null,!1;this.data[this.field.name]=this.data[this.field.name+".label"]=null}"function"==typeof e.doafterAutoCompleteSelect[this.field.name]&&e.doafterAutoCompleteSelect[this.field.name].call(this,this.data,t,n,a);var r=this.field;i(function(){jQuery("#"+r.name).trigger("keyup")})},e.autocomplete=function(e,t){return this._autocomplete(e,t,null)},e.autocompleteDetail=function(e,t,n){return this._autocomplete(t,n,e)},e.autocompleteSelect=function(e,t,n,a){this._autocompleteSelect(t,n,a,null)},e.autocompleteDetailSelect=function(e,t,n,a){this._autocompleteSelect(t,n,a,e)}},500)}])}();